
(()=>{const USE_REAL_TRAILER_PREVIEWS=false;const API_KEY="";const STYLE_URL=window.__FLIXFIN_STYLE_URL__||"/flixfin/dist/style.css";const BILLBOARD_ROTATE_MS=8000;function addStyle(){if(document.getElementById("flixfin-style"))return;const l=document.createElement("link");l.id="flixfin-style";l.rel="stylesheet";l.href=STYLE_URL;document.head.appendChild(l)}function onReady(fn){if(document.readyState!=="loading")fn();else document.addEventListener("DOMContentLoaded",fn)}function waitFor(selector,root=document,timeout=12000){return new Promise((resolve,reject)=>{const t0=Date.now();const iv=setInterval(()=>{const el=root.querySelector(selector);if(el){clearInterval(iv);resolve(el)}if(Date.now()-t0>timeout){clearInterval(iv);reject(new Error("timeout waiting "+selector))}},150)})}function collectBackdrops(limit=8){const imgs=Array.from(document.querySelectorAll(".cardImageContainer img, .primaryImageWrapper img")).map(img=>img.getAttribute("src")||img.getAttribute("data-src")||img.currentSrc).filter(Boolean);const unique=[...new Set(imgs)].slice(0,limit);return unique}function buildBillboard(){if(document.getElementById("flix-billboard"))return;const bb=document.createElement("section");bb.id="flix-billboard";bb.innerHTML=`
      <div class="bg" id="flix-bb-bg1"></div>
      <div class="bg fadeout" id="flix-bb-bg2"></div>
      <div class="mask"></div>
      <div class="content">
        <h1 id="flix-bb-title">Just for you</h1>
        <p id="flix-bb-desc">Personalized picks from your library.</p>
        <div class="actions">
          <button class="btn play" id="flix-bb-play">▶ Play</button>
          <button class="btn more" id="flix-bb-more">ℹ More Info</button>
        </div>
      </div>
    `;const firstSection=document.querySelector(".section, .verticalSection");if(firstSection&&firstSection.parentElement){firstSection.parentElement.insertBefore(bb,firstSection)}else{document.body.prepend(bb)}let idx=0;function setBG(imgUrl){const a=document.getElementById("flix-bb-bg1");const b=document.getElementById("flix-bb-bg2");const showA=idx%2===0;(showA?a:b).style.backgroundImage=`url('${imgUrl}')`; (showA?b:a).classList.add("fadeout"); (showA?a:b).classList.remove("fadeout")}const pool=collectBackdrops(10);if(pool.length){setBG(pool[0]);setInterval(()=>{idx++;setBG(pool[idx%pool.length])},8000)}const firstCard=document.querySelector(".itemsContainer .card button.emby-button, .itemsContainer .card");const playBtn=document.getElementById("flix-bb-play");const moreBtn=document.getElementById("flix-bb-more");if(firstCard&&playBtn){playBtn.onclick=()=>firstCard.click()}if(moreBtn){moreBtn.onclick=()=>window.scrollTo({top:window.innerHeight*0.8,behavior:"smooth"})}}function enhanceCards(){document.querySelectorAll(".card").forEach(card=>{if(card.__flixEnhanced)return;card.__flixEnhanced=true;const footer=document.createElement("div");footer.className="flix-hover";footer.textContent=card.getAttribute("aria-label")||(card.querySelector(".textActionButton")?.textContent||"Play");card.appendChild(footer);card.setAttribute("tabindex","0");card.addEventListener("keydown",e=>{if(e.key==="Enter"||e.key===" "){const btn=card.querySelector("button.emby-button")||card;btn.click();e.preventDefault()}})})}function observe(){const obs=new MutationObserver(()=>{enhanceCards()});obs.observe(document.body,{childList:true,subtree:true})}async function boot(){addStyle();try{await waitFor(".itemsContainer, .homePage")}catch{}buildBillboard();enhanceCards();observe()}function run(){boot()}function tryRun(){if(document.location.pathname.includes("/web"))run()}document.addEventListener("readystatechange",tryRun);onReady(tryRun);})();
